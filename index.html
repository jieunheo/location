<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wedding Day</title>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <link rel="preconnect" href="//fonts.googleapis.com">
  <link rel="preconnect" href="//fonts.gstatic.com" crossorigin>
  <link href="//fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&display=swap" rel="stylesheet">
  <link href="//fonts.googleapis.com/css2?family=Dancing+Script:wght@400..700&family=Gowun+Dodum&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="./css/style.css">
  <link rel="stylesheet" href="./css/heart_animation.css">

  <link rel="stylesheet" href="./css/blossom.css">
  <script src="./js/blossom.js"></script>
  <script>
    $(window).load(function () {
      // 배경 타입 선택 여부 확인
      const searchParams = new URLSearchParams(location.search);
      let type = '';
      for (const param of searchParams) {
        type = param[1];
      }

      if(!type) { // 배경 타입 선택 안한 경우 랜덤
        const randomNum = Math.random() * 2;
        type = Math.round(randomNum);
      }
      // 배경 타입 설정
      $('body').addClass('type'+type);

      // 현재 배경 버튼 텍스트 수정
      $('#name'+type).addClass('active');
      let type_name = 'Sky';
      switch (type) {
        case '1':
        case 1: type_name = 'Blossoms'; break;
        case '2':
        case 2: type_name = 'Leaf'; break;
      }
      $('#name'+type+" button").html(type_name);

      // 흩날리는 애니메이션 적용
      $('body').sakura();

      // 배경음악 설정
      var bgm = document.getElementById('bgm');
      $('#btn_bgm_control').on('click', function(e) {
        e.preventDefault();
        if ( bgm.paused ) {
          $(this).find('img').attr('src', $(this).find('img').attr('src').replace(/off\.gif$/, 'on.gif'));
          bgm.play();
        } else {
          $(this).find('img').attr('src', $(this).find('img').attr('src').replace(/on\.gif$/, 'off.gif'));
          bgm.pause();
        }
      });

      // 디데이 처음 실행
      dayCount();
    });

    // 디데이 설정
    var countdownInterval = setInterval(dayCount, 1000);
    function dayCount() {
      const today = new Date();
      const dday = new Date("2024-08-31");
      let timeGap = dday.getTime() - today.getTime();
      
      // 남은 일
      const remainTime = Math.ceil(timeGap / (1000 * 60 * 60 * 24));

      // 적용
      if(timeGap > 0) {
        $('#day_count').text(remainTime);

      } else {
        $('#day_count').text('Day');

        // 남은 시간
        const starttime = new Date("2024-08-31 13:00:00");
        timeGap = starttime.getTime() - today.getTime();
        if(timeGap <= 0) {
          $('#end').css('display','block');
          $('.time').css('display','none');
          clearInterval(countdownInterval);
          return;
        }
        const hours = String(Math.floor((timeGap % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60))).padStart(2,'0');
        const minutes = String(Math.floor((timeGap % (1000 * 60 * 60)) / (1000 * 60))).padStart(2,'0');
        const seconds = String(Math.floor((timeGap % (1000 * 60)) / 1000)).padStart(2,'0');
        
        $('#seconds').text(seconds);
        $('#minutes').text(minutes);
        $('#hours').text(hours);

        if($('.time').css('display') == 'none') {
          $('.time').css('display','block');
        }
      }
    }

    function go_type(type) {
      window.location.replace("?type=" + type);
    }
  </script>
</head>
<body>

  <main>
    <div class="types_wrap">
      <div class="flex">
        <div class="music">
          <a class="music_btn" href="#" id="btn_bgm_control"><img src="./img/sound_on.gif"></a>
          <audio id="bgm" loop="loop" autoplay="autoplay">
            <source src="./music/스윗소로우-좋겠다(feat. 오지은, 정준일).mp3" type="audio/mp3">
          </audio>
        </div>
        <div class="line">|</div>
        <div id="name0" data-type="S"><button onclick="go_type(0)">S</button></div>
        <div id="name1" data-type="B"><button onclick="go_type(1)">B</button></div>
        <div id="name2" data-type="L"><button onclick="go_type(2)">L</button></div>
      </div>
    </div>

    <div class="photo-wrap">
      <h1>Wedding Day</h1>
      <h2>2024.08.31</h2>
      <div class="img">
        <p class="day">D-<span id="day_count">Day</span></p>
        <p class="time">
          <span id="hours">00</span> :
          <span id="minutes">00</span> :
          <span id="seconds">00</span>
        </p>
        <p id="end">
          축하해주셔서 감사합니다.
        </p>
      </div>
      <h3>
        조하진
        <label for="checkbox">
          <input type="checkbox" id="checkbox" hidden checked>
          <svg t="1689815540548" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2271"><path d="M742.4 101.12A249.6 249.6 0 0 0 512 256a249.6 249.6 0 0 0-230.72-154.88C143.68 101.12 32 238.4 32 376.32c0 301.44 416 546.56 480 546.56s480-245.12 480-546.56c0-137.92-111.68-275.2-249.6-275.2z" fill="#231F20" p-id="2272" id="heart"></path></svg>
          <span></span>
        </label>
        허지은
      </h3>
    </div>

    <div class="btn-wrap">
      <div>
        <a href="javascript: alert('Coming Soon...')">모바일 청첩장</a>
      </div>
      <div>
        <a href="https://m.map.kakao.com/actions/detailMapView?id=476733690&refService=place" target="_blank">예식장 위치</a>
      </div>
    </div>
  </main>
  <footer>
    <p>Copyright (c) <b>HeoJieun</b> All Rights Reserved.</p>
  </footer>
</body>
</html>